{% extends "base.html" %}

{% block title %}Routes - Asort Design{% endblock %}

{% block content %}
  <div class="card">
    <h2>Routes</h2>
    <p class="muted">Audience distribution and recent routing activity.</p>
  </div>

  <div class="row">
    <div class="card">
      <h3>Route Totals</h3>
      <ul>
        {% for aud, label in audience_display.items() %}
          <li>
            <strong
              class="{% if label == 'Cross-Functional' %}tooltip{% endif %}"
              {% if label == 'Cross-Functional' %}
                data-tip="Mixed stakeholders (see request for details)"
              {% endif %}
            >
              {{ label }}
            </strong>: {{ totals.get(aud, 0) }}
          </li>
        {% endfor %}
      </ul>
      <div class="actions">
        <a class="button" href="/web/documents">Browse Documents</a>
      </div>
    </div>
    <div class="card">
      <h3>Recent Routing</h3>
      {% if recent %}
        <ul>
          {% for item in recent %}
            <li>
              <strong
                class="{% if item.audience == 'Cross-Functional' %}tooltip{% endif %}"
                {% if item.audience == 'Cross-Functional' %}
                  data-tip="Mixed stakeholders (see request for details)"
                {% endif %}
              >
                {{ item.audience }}
              </strong>
              <span class="status-chip status-{{ item.status }}">{{ item.status }}</span>
              <span class="muted"> â€¢ {{ item.created_at }}</span>
              <div class="actions">
                <a class="button" href="/web/jobs/{{ item.job_id }}">View Request</a>
              </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="muted">No routes yet.</p>
      {% endif %}
    </div>
  </div>
{% endblock %}
